<div *ngIf="!bookFormVisible &&(!books || books.empty)" class="mt-lg-5 pt-lg-5 "></div>
<div *ngIf="!bookFormVisible &&(!books || books.empty)" class="mt-lg-5 pt-lg-5 "></div>
<app-logo [headerClass]="'text-center  mt-5  pt-5 '"></app-logo>
<div class="container mt-5">
  <datalist id="listTitles"  *ngIf="titles">
    <select class="form-control" >
      <option *ngFor="let title of titles" [value]="title.title"></option>
    </select>
  </datalist>
  <div [class]="bookFormVisible?'container':'input-group text-center '">
      <input  list="listTitles" [(ngModel)]="searchText" *ngIf="!bookFormVisible" (ngModelChange)="searchBookByTitle(searchText,1)" type="text"  [class]="'col-lg-5 ml-auto form-control border-right-0 border-secondary'" placeholder="Search...">

      <button *ngIf="!bookFormVisible"  [disabled]="loading || !searchText" (click)="searchBookByTitle(searchText)" class="btn no-focus btn-outline-secondary   text-center mb-2 border-radius-0"><fa-icon [icon]="['fas','search']" ></fa-icon>{{books && books.content ? ' ('+books.totalElements+')' : ''}}</button>

    <div  [ngClass]="bookFormVisible ? '':'btn-group mr-auto'">
      <button *ngIf="!bookFormVisible && isLoggedIn()"  [disabled]="loading" (click)="getBooks(1)" class="btn border-radius-0 no-focus btn-outline-secondary border-left-0  mb-2  "><fa-icon [icon]="faSync" ></fa-icon></button>
      <app-book-form (bookCreatedCallback)="getBooks(1)" (emitter)="bookFormVisible = $event" *ngIf="hasRole('ADMIN')" [editMode]="false" [book]="newBook()"></app-book-form>
    </div>

  </div>
  <div class=" table-responsive mt-2 " *ngIf="!bookFormVisible && books &&!books.empty">
    <table class="table table-hover table-light table-sm">
      <thead>
      <tr class="bg-light">
        <th scope="col">
          <small>{{'title' | uppercase }}</small>
        </th>
        <th scope="col">
          <small>{{'category' | uppercase }}</small>
        </th>
        <th scope="col">
          <small>{{'Duration' | uppercase }}</small>
        </th>
        <th scope="col">
          <small>{{'Lang' | uppercase }}</small>
        </th>
        <th scope="col" colspan="3" *ngIf="hasRole('ADMIN')">
          <small>{{'action' | uppercase }}</small>
        </th>
      </tr>
      </thead>
      <tbody *ngIf="books && !books.empty">
      <tr class="clickable" (click)="navigate(book,'view')" *ngFor="let book of books.content | paginate: { itemsPerPage: books.size, currentPage: books.number+1, totalItems: books.totalElements}">
        <td>{{book.title}}</td>
        <td>{{book.category}}</td>
        <td>{{getTotalDuration(book)}}</td>
        <td><span [ngClass]="'flag-icon flag-icon-'+ (book.lang ? book.lang.toLowerCase() : 'us')"></span></td>
        <td colspan="3">
          <div class="btn-group">
<!--            <button [id]="book.id + 'viewaction'" (click)="navigate(book,'view')" class="btn btn-sm btn-primary" aria-label="View"><fa-icon [icon]="faEye"></fa-icon></button>-->
            <button [id]="book.id + 'editaction'" *ngIf="hasRole('ADMIN')" (click)="navigate(book,'edit')" class="btn btn-sm btn-warning"
                    aria-label="Edit"><fa-icon [icon]="faEdit"></fa-icon></button>

            <button [id]="book.id+'delaction'" *ngIf="hasRole('ADMIN')" (click)="delete(book,$event)" class="btn btn-sm btn-danger" aria-label="Delete"><fa-icon [icon]="faTrash"></fa-icon> </button>
          </div>
        </td>
      </tr>
      </tbody>
      <tbody *ngIf="!books || books.empty ">
      <tr class="bg-dark">
        <td colspan="11" class="text-white text-uppercase text-center"><strong>No result!</strong></td>
      </tr>
      </tbody>
    </table>
  </div>
  <div *ngIf="books && !books.empty && books.totalPages  > 1"
       class="text-center container mt-2 mr-1 mb-3 pb-1 ">
    <div class="text-wrap">
      <pagination-controls (pageChange)="getBooks($event)"
                           previousLabel=""
                           autoHide="true"
                           class="my-pagination "
                           nextLabel="">
      </pagination-controls>
    </div>
  </div>
</div>
